<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Yunqi Yang" />


<title>R2BGLiMS</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">survival-susie</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/yunqiyang0215/survival-susie">
    <span class="fa fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">R2BGLiMS</h1>
<h4 class="author">Yunqi Yang</h4>
<h4 class="date">1/18/2024</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2024-02-26
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>survival-susie/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20230201code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20230201)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20230201code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20230201)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomyunqiyang0215survivalsusietreefa2a63bf9fc2b85423d8ad07f916b9cbe37bff62targetblankfa2a63ba"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/yunqiyang0215/survival-susie/tree/fa2a63bf9fc2b85423d8ad07f916b9cbe37bff62" target="_blank">fa2a63b</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomyunqiyang0215survivalsusietreefa2a63bf9fc2b85423d8ad07f916b9cbe37bff62targetblankfa2a63ba" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/yunqiyang0215/survival-susie/tree/fa2a63bf9fc2b85423d8ad07f916b9cbe37bff62" target="_blank">fa2a63b</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/R2BGLiMS.Rmd</code>) and HTML (<code>docs/R2BGLiMS.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/yunqiyang0215/survival-susie/blob/fa2a63bf9fc2b85423d8ad07f916b9cbe37bff62/analysis/R2BGLiMS.Rmd" target="_blank">fa2a63b</a>
</td>
<td>
yunqiyang0215
</td>
<td>
2024-02-26
</td>
<td>
wflow_publish("analysis/R2BGLiMS.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/yunqiyang0215/survival-susie/7dc4c98e8408217a30107832b44ab7c9ef8fa479/docs/R2BGLiMS.html" target="_blank">7dc4c98</a>
</td>
<td>
yunqiyang0215
</td>
<td>
2024-01-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/yunqiyang0215/survival-susie/blob/5ef9ce0d551f220447c63a31dda9c68c9f75de8c/analysis/R2BGLiMS.Rmd" target="_blank">5ef9ce0</a>
</td>
<td>
yunqiyang0215
</td>
<td>
2024-01-18
</td>
<td>
wflow_publish("analysis/R2BGLiMS.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/yunqiyang0215/survival-susie/2c660007b36317c1351d015155b31bbb0905af22/docs/R2BGLiMS.html" target="_blank">2c66000</a>
</td>
<td>
yunqiyang0215
</td>
<td>
2024-01-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/yunqiyang0215/survival-susie/blob/a6faa50df12e4a90e44acebadd22fa4b1e5d99cd/analysis/R2BGLiMS.Rmd" target="_blank">a6faa50</a>
</td>
<td>
yunqiyang0215
</td>
<td>
2024-01-18
</td>
<td>
wflow_publish("analysis/R2BGLiMS.Rmd")
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<pre class="r"><code>#install_github(&quot;pjnewcombe/R2BGLiMS&quot;)
library(R2BGLiMS)</code></pre>
<pre class="r"><code># https://github.com/pjnewcombe/R2BGLiMS/blob/master/Examples/R2BGLiMS_Examples.R
# Example usage from the package
utils::data(VA, package = &quot;MASS&quot;)
predictors &lt;- c(&quot;treat&quot;,&quot;age&quot;,&quot;Karn&quot;,&quot;diag.time&quot;,&quot;prior&quot;)
for (v in predictors) {VA[,v] &lt;- scale(as.numeric(VA[,v]))} # Normalise predictors
VA$stime &lt;- VA$stime/max(VA$stime)# Recommend scaling survival times to between 0 and 1

va.results.weibull &lt;- R2BGLiMS(
  likelihood=&quot;Weibull&quot;,
  data=VA,
  outcome.var=&quot;status&quot;,
  times.var=&quot;stime&quot;,
  model.space.priors=list(list(&quot;a&quot;=1,&quot;b&quot;=length(predictors),&quot;Variables&quot;=predictors)) # Beta-binomial(1,P) model space prior
)

plot(va.results.weibull@mcmc.output[,&quot;LogLikelihood&quot;], type=&quot;l&quot;) # Looks ok
ManhattanPlot(va.results.weibull) # Clear signal at Kern
va.results.weibull@posterior.summary.table
TopModels(va.results.weibull)</code></pre>
<pre class="r"><code>dat = readRDS(&quot;./data/sim_dat_censoring.rds&quot;)</code></pre>
<div id="data-1-null-model-with-x-independent" class="section level3">
<h3>Data 1: null model with X independent</h3>
<pre class="r"><code>p = 50
X = as.data.frame(dat[[1]][, c(2:(p+1))])
data = dat[[1]]
data$surT = data$surT/max(data$surT)
predictors = names(data)[2:51]
for (v in predictors) {data[,v] &lt;- scale(as.numeric(data[,v]))} # Normalise predictors

res &lt;- R2BGLiMS(
  likelihood=&quot;Weibull&quot;,
  data=data,
  outcome.var=&quot;status&quot;,
  times.var=&quot;surT&quot;,
  model.space.priors=list(list(&quot;a&quot;=1,&quot;b&quot;=length(predictors),&quot;Variables&quot;=predictors)) # Beta-binomial(1,P) model space prior
)

plot(res@mcmc.output[,&quot;LogLikelihood&quot;], type=&quot;l&quot;) # Looks ok</code></pre>
<p><img src="figure/R2BGLiMS.Rmd/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-4-1">
Past versions of unnamed-chunk-4-1.png
</button>
</p>
<div id="fig-unnamed-chunk-4-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/yunqiyang0215/survival-susie/blob/2c660007b36317c1351d015155b31bbb0905af22/docs/figure/R2BGLiMS.Rmd/unnamed-chunk-4-1.png" target="_blank">2c66000</a>
</td>
<td>
yunqiyang0215
</td>
<td>
2024-01-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>ManhattanPlot(res) # Clear signal at Kern</code></pre>
<p><img src="figure/R2BGLiMS.Rmd/unnamed-chunk-4-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-4-2">
Past versions of unnamed-chunk-4-2.png
</button>
</p>
<div id="fig-unnamed-chunk-4-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/yunqiyang0215/survival-susie/blob/2c660007b36317c1351d015155b31bbb0905af22/docs/figure/R2BGLiMS.Rmd/unnamed-chunk-4-2.png" target="_blank">2c66000</a>
</td>
<td>
yunqiyang0215
</td>
<td>
2024-01-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>res@posterior.summary.table</code></pre>
<pre><code>                    PostProb     Median   CrI_Lower  CrI_Upper Median_Present
LogWeibullScale           NA  0.1610626 -0.03859787  0.3430198             NA
alpha                     NA  1.3523057  1.00867924  1.6926551             NA
x1                    0.0118  1.0000000  1.00000000  1.0000000      1.0298616
x2                    0.0078  1.0000000  1.00000000  1.0000000      0.9222471
x3                    0.0074  1.0000000  1.00000000  1.0000000      0.9825414
x4                    0.0840  1.0000000  0.68725426  1.0000000      0.7509737
x5                    0.0066  1.0000000  1.00000000  1.0000000      1.0308882
x6                    0.0116  1.0000000  1.00000000  1.0000000      0.9928074
x7                    0.0192  1.0000000  1.00000000  1.0000000      1.1608772
x8                    0.0104  1.0000000  1.00000000  1.0000000      1.0279673
x9                    0.0100  1.0000000  1.00000000  1.0000000      0.9720276
x10                   0.0114  1.0000000  1.00000000  1.0000000      1.0916807
x11                   0.0092  1.0000000  1.00000000  1.0000000      1.0756126
x12                   0.0242  1.0000000  1.00000000  1.0000000      1.1541694
x13                   0.0134  1.0000000  1.00000000  1.0000000      1.0701177
x14                   0.0098  1.0000000  1.00000000  1.0000000      0.9840410
x15                   0.0146  1.0000000  1.00000000  1.0000000      0.9182738
x16                   0.0172  1.0000000  1.00000000  1.0000000      1.1671183
x17                   0.0140  1.0000000  1.00000000  1.0000000      1.0645570
x18                   0.0082  1.0000000  1.00000000  1.0000000      0.9912891
x19                   0.0100  1.0000000  1.00000000  1.0000000      0.9768022
x20                   0.0208  1.0000000  1.00000000  1.0000000      1.1171953
x21                   0.0096  1.0000000  1.00000000  1.0000000      1.0211766
x22                   0.0106  1.0000000  1.00000000  1.0000000      1.0555998
x23                   0.0134  1.0000000  1.00000000  1.0000000      1.0602316
x24                   0.0088  1.0000000  1.00000000  1.0000000      0.9907174
x25                   0.0108  1.0000000  1.00000000  1.0000000      1.0144766
x26                   0.0092  1.0000000  1.00000000  1.0000000      1.0446394
x27                   0.0114  1.0000000  1.00000000  1.0000000      1.0142065
x28                   0.0122  1.0000000  1.00000000  1.0000000      1.0151620
x29                   0.0092  1.0000000  1.00000000  1.0000000      0.9914933
x30                   0.0182  1.0000000  1.00000000  1.0000000      0.9119851
x31                   0.0094  1.0000000  1.00000000  1.0000000      1.0387009
x32                   0.0120  1.0000000  1.00000000  1.0000000      0.9960081
x33                   0.0432  1.0000000  0.86422280  1.0000000      0.8425086
x34                   0.0114  1.0000000  1.00000000  1.0000000      0.9912316
x35                   0.0080  1.0000000  1.00000000  1.0000000      1.0380251
x36                   0.0118  1.0000000  1.00000000  1.0000000      1.0752425
x37                   0.0150  1.0000000  1.00000000  1.0000000      1.0737083
x38                   0.0132  1.0000000  1.00000000  1.0000000      0.9124204
x39                   0.0114  1.0000000  1.00000000  1.0000000      1.0122803
x40                   0.0106  1.0000000  1.00000000  1.0000000      0.9755629
x41                   0.0088  1.0000000  1.00000000  1.0000000      0.9723356
x42                   0.0130  1.0000000  1.00000000  1.0000000      0.9476594
x43                   0.0100  1.0000000  1.00000000  1.0000000      0.9707956
x44                   0.0118  1.0000000  1.00000000  1.0000000      1.0186080
x45                   0.0106  1.0000000  1.00000000  1.0000000      0.9708240
x46                   0.0094  1.0000000  1.00000000  1.0000000      0.9868755
x47                   0.0206  1.0000000  1.00000000  1.0000000      1.1175214
x48                   0.0110  1.0000000  1.00000000  1.0000000      1.0267645
x49                   0.0102  1.0000000  1.00000000  1.0000000      1.0061941
x50                   0.0120  1.0000000  1.00000000  1.0000000      0.9651467
LogBetaPriorSd1           NA -1.4779983 -2.91948901  0.5516384             NA
LogLikelihood             NA 10.6204232  7.55639267 14.3789036             NA
ModelSizePartition1       NA  0.0000000  0.00000000  4.0000000             NA
                    CrI_Lower_Present CrI_Upper_Present          Mean        BF
LogWeibullScale                    NA                NA  1.578727e-01        NA
alpha                              NA                NA  1.353113e+00        NA
x1                          0.8385173         1.2278986  4.056603e-04 0.5970451
x2                          0.8036259         1.1442149 -4.890066e-04 0.3930659
x3                          0.8432772         1.1475181 -1.005020e-04 0.3727584
x4                          0.5551397         0.9953443 -2.411827e-02 4.5851528
x5                          0.8462231         1.2160924  1.171213e-04 0.3321925
x6                          0.7806497         1.1743874 -3.116115e-04 0.5868070
x7                          0.9345827         1.5390479  3.071849e-03 0.9787928
x8                          0.8650605         1.1890042  2.495298e-04 0.5254648
x9                          0.7897455         1.1616287 -2.914539e-04 0.5050505
x10                         0.9659762         1.2375802  9.731853e-04 0.5765729
x11                         0.9480440         1.3255075  7.321774e-04 0.4642713
x12                         0.9356364         1.6105462  3.866233e-03 1.2400082
x13                         0.9104773         1.3227697  1.128948e-03 0.6790999
x14                         0.6888248         1.2365271 -5.113222e-04 0.4948495
x15                         0.6814959         1.0579827 -1.364633e-03 0.7408159
x16                         0.9399044         1.4903562  2.835523e-03 0.8750509
x17                         0.9104347         1.4991328  1.271044e-03 0.7099391
x18                         0.7868482         1.2221227 -1.469781e-04 0.4133898
x19                         0.8391067         1.0996349 -3.128983e-04 0.5050505
x20                         0.9621975         1.3337463  2.271505e-03 1.0620915
x21                         0.8473778         1.3050489  1.638223e-04 0.4846527
x22                         0.8479096         1.3775563  5.490915e-04 0.5356782
x23                         0.8954653         1.3838672  9.878134e-04 0.6790999
x24                         0.7840380         1.1770972 -1.146439e-04 0.4439064
x25                         0.8561833         1.2140222  2.657550e-04 0.5458957
x26                         0.8916557         1.2950255  4.094429e-04 0.4642713
x27                         0.8980633         1.1307724  1.203900e-04 0.5765729
x28                         0.8906966         1.1841907  2.705756e-04 0.6175339
x29                         0.8285485         1.2325198 -8.258274e-05 0.4642713
x30                         0.6533845         1.0925309 -2.022213e-03 0.9268690
x31                         0.9113874         1.3556771  4.821317e-04 0.4744599
x32                         0.8203374         1.2333048 -6.532424e-05 0.6072874
x33                         0.6207846         1.0124556 -7.941090e-03 2.2575251
x34                         0.8113243         1.1354075 -1.424641e-04 0.5765729
x35                         0.9316220         1.3358990  4.128845e-04 0.4032258
x36                         0.9432339         1.3596241  9.974137e-04 0.5970451
x37                         0.9277349         1.3091062  1.216866e-03 0.7614213
x38                         0.7204585         1.0625170 -1.322034e-03 0.6688285
x39                         0.8903351         1.2675370  4.505318e-04 0.5765729
x40                         0.8387929         1.2300552 -1.198295e-04 0.5356782
x41                         0.8132461         1.0930012 -3.623641e-04 0.4439064
x42                         0.7454924         1.0759765 -1.045615e-03 0.6585613
x43                         0.7984339         1.1930454 -2.013416e-04 0.5050505
x44                         0.8445735         1.1741158  2.580343e-04 0.5970451
x45                         0.7157204         1.1173178 -5.617284e-04 0.5356782
x46                         0.8560917         1.2757090 -6.113719e-05 0.4744599
x47                         0.9175270         1.5853009  2.567450e-03 1.0516643
x48                         0.9138974         1.2310802  3.963654e-04 0.5561173
x49                         0.9152075         1.1897003  1.340182e-04 0.5152556
x50                         0.7970702         1.1196662 -4.178370e-04 0.6072874
LogBetaPriorSd1                    NA                NA -1.366380e+00        NA
LogLikelihood                      NA                NA  1.058359e+01        NA
ModelSizePartition1                NA                NA            NA        NA</code></pre>
<pre class="r"><code>TopModels(res)</code></pre>
<pre><code>      x4 x7 x10 x12 x14 x15 x16 x17 x19 x20 x23 x28 x30 x33 x37 x38 x42 x47
 [1,]  0  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 [2,]  1  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 [3,]  0  0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0
 [4,]  0  0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 [5,]  0  0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0
 [6,]  1  0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0
 [7,]  0  0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0
 [8,]  0  0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0
 [9,]  0  1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
[10,]  0  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1
[11,]  0  0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0
[12,]  0  0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
[13,]  0  0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0
[14,]  0  0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0
[15,]  0  0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0
[16,]  0  0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0
[17,]  0  0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0
[18,]  0  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0
[19,]  0  0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0
[20,]  0  0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0
      Post Prob
 [1,]    0.6032
 [2,]    0.0364
 [3,]    0.0118
 [4,]    0.0086
 [5,]    0.0082
 [6,]    0.0070
 [7,]    0.0068
 [8,]    0.0064
 [9,]    0.0064
[10,]    0.0058
[11,]    0.0058
[12,]    0.0050
[13,]    0.0048
[14,]    0.0048
[15,]    0.0046
[16,]    0.0046
[17,]    0.0046
[18,]    0.0044
[19,]    0.0044
[20,]    0.0042</code></pre>
</div>
<div id="data-2-simulated-from-null-model-with-highly-correlated-x.-corr-0.9" class="section level3">
<h3>Data 2: simulated from null model with highly correlated X. corr = 0.9</h3>
<pre class="r"><code>p = 50
X = as.data.frame(dat[[2]][, c(2:(p+1))])
data = dat[[2]]
data$surT = data$surT/max(data$surT)
predictors = names(data)[2:51]
for (v in predictors) {data[,v] &lt;- scale(as.numeric(data[,v]))} # Normalise predictors

res &lt;- R2BGLiMS(
  likelihood=&quot;Weibull&quot;,
  data=data,
  outcome.var=&quot;status&quot;,
  times.var=&quot;surT&quot;,
  model.space.priors=list(list(&quot;a&quot;=1,&quot;b&quot;=length(predictors),&quot;Variables&quot;=predictors)) # Beta-binomial(1,P) model space prior
)

plot(res@mcmc.output[,&quot;LogLikelihood&quot;], type=&quot;l&quot;) # Looks ok</code></pre>
<p><img src="figure/R2BGLiMS.Rmd/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-5-1">
Past versions of unnamed-chunk-5-1.png
</button>
</p>
<div id="fig-unnamed-chunk-5-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/yunqiyang0215/survival-susie/blob/2c660007b36317c1351d015155b31bbb0905af22/docs/figure/R2BGLiMS.Rmd/unnamed-chunk-5-1.png" target="_blank">2c66000</a>
</td>
<td>
yunqiyang0215
</td>
<td>
2024-01-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>ManhattanPlot(res) # Clear signal at Kern</code></pre>
<p><img src="figure/R2BGLiMS.Rmd/unnamed-chunk-5-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-5-2">
Past versions of unnamed-chunk-5-2.png
</button>
</p>
<div id="fig-unnamed-chunk-5-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/yunqiyang0215/survival-susie/blob/2c660007b36317c1351d015155b31bbb0905af22/docs/figure/R2BGLiMS.Rmd/unnamed-chunk-5-2.png" target="_blank">2c66000</a>
</td>
<td>
yunqiyang0215
</td>
<td>
2024-01-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>res@posterior.summary.table</code></pre>
<pre><code>                    PostProb     Median   CrI_Lower  CrI_Upper Median_Present
LogWeibullScale           NA  0.1573666 -0.03929995  0.3338704             NA
alpha                     NA  1.3462748  1.00382054  1.6864094             NA
x1                    0.0148  1.0000000  1.00000000  1.0000000      1.0505131
x2                    0.0120  1.0000000  1.00000000  1.0000000      0.9621199
x3                    0.0100  1.0000000  1.00000000  1.0000000      1.0490140
x4                    0.0166  1.0000000  1.00000000  1.0000000      0.8590102
x5                    0.0088  1.0000000  1.00000000  1.0000000      1.0395732
x6                    0.0136  1.0000000  1.00000000  1.0000000      1.0094488
x7                    0.0138  1.0000000  1.00000000  1.0000000      1.0822911
x8                    0.0120  1.0000000  1.00000000  1.0000000      1.0372199
x9                    0.0130  1.0000000  1.00000000  1.0000000      1.0056934
x10                   0.0132  1.0000000  1.00000000  1.0000000      1.0693509
x11                   0.0104  1.0000000  1.00000000  1.0000000      1.0525753
x12                   0.0156  1.0000000  1.00000000  1.0000000      1.1064793
x13                   0.0110  1.0000000  1.00000000  1.0000000      1.0292432
x14                   0.0100  1.0000000  1.00000000  1.0000000      1.0169847
x15                   0.0088  1.0000000  1.00000000  1.0000000      1.0054349
x16                   0.0154  1.0000000  1.00000000  1.0000000      1.0285885
x17                   0.0146  1.0000000  1.00000000  1.0000000      1.0429540
x18                   0.0126  1.0000000  1.00000000  1.0000000      1.0320212
x19                   0.0106  1.0000000  1.00000000  1.0000000      0.9952058
x20                   0.0126  1.0000000  1.00000000  1.0000000      1.0595765
x21                   0.0126  1.0000000  1.00000000  1.0000000      1.0165179
x22                   0.0114  1.0000000  1.00000000  1.0000000      1.0331708
x23                   0.0110  1.0000000  1.00000000  1.0000000      1.0845380
x24                   0.0112  1.0000000  1.00000000  1.0000000      1.0377338
x25                   0.0104  1.0000000  1.00000000  1.0000000      1.0015831
x26                   0.0110  1.0000000  1.00000000  1.0000000      1.0288480
x27                   0.0144  1.0000000  1.00000000  1.0000000      1.0150339
x28                   0.0100  1.0000000  1.00000000  1.0000000      1.0545216
x29                   0.0104  1.0000000  1.00000000  1.0000000      1.0045091
x30                   0.0124  1.0000000  1.00000000  1.0000000      1.0010722
x31                   0.0100  1.0000000  1.00000000  1.0000000      1.0521620
x32                   0.0092  1.0000000  1.00000000  1.0000000      1.0223548
x33                   0.0096  1.0000000  1.00000000  1.0000000      0.9734014
x34                   0.0130  1.0000000  1.00000000  1.0000000      1.0250531
x35                   0.0118  1.0000000  1.00000000  1.0000000      1.0487839
x36                   0.0106  1.0000000  1.00000000  1.0000000      1.0425183
x37                   0.0142  1.0000000  1.00000000  1.0000000      1.0664828
x38                   0.0094  1.0000000  1.00000000  1.0000000      0.9735843
x39                   0.0116  1.0000000  1.00000000  1.0000000      1.0482194
x40                   0.0100  1.0000000  1.00000000  1.0000000      0.9999344
x41                   0.0112  1.0000000  1.00000000  1.0000000      1.0205169
x42                   0.0134  1.0000000  1.00000000  1.0000000      0.9929131
x43                   0.0108  1.0000000  1.00000000  1.0000000      0.9980711
x44                   0.0092  1.0000000  1.00000000  1.0000000      1.0156867
x45                   0.0106  1.0000000  1.00000000  1.0000000      1.0648342
x46                   0.0108  1.0000000  1.00000000  1.0000000      1.0206047
x47                   0.0116  1.0000000  1.00000000  1.0000000      1.0425634
x48                   0.0152  1.0000000  1.00000000  1.0000000      1.1109617
x49                   0.0116  1.0000000  1.00000000  1.0000000      1.0566236
x50                   0.0112  1.0000000  1.00000000  1.0000000      0.9762453
LogBetaPriorSd1           NA -1.5562101 -2.93414083  0.5716752             NA
LogLikelihood             NA 10.4982380  7.40550687 11.4909100             NA
ModelSizePartition1       NA  0.0000000  0.00000000  4.0000000             NA
                    CrI_Lower_Present CrI_Upper_Present          Mean        BF
LogWeibullScale                    NA                NA  1.550465e-01        NA
alpha                              NA                NA  1.343940e+00        NA
x1                          0.8886717          1.317123  8.291977e-04 0.7511165
x2                          0.7537281          1.148837 -3.776899e-04 0.6072874
x3                          0.8521995          1.376412  6.422668e-04 0.5050505
x4                          0.6201365          1.130226 -2.699105e-03 0.8440106
x5                          0.8275922          1.334288  3.393182e-04 0.4439064
x6                          0.7182954          1.305545 -1.415235e-05 0.6893755
x7                          0.9162788          1.462001  1.600606e-03 0.6996552
x8                          0.8186772          1.335148  7.062224e-04 0.6072874
x9                          0.8108004          1.788948  9.311804e-04 0.6585613
x10                         0.9281549          1.362469  1.045281e-03 0.6688285
x11                         0.9153016          1.373172  7.363456e-04 0.5254648
x12                         0.8964094          1.475600  1.960404e-03 0.7923608
x13                         0.8847493          1.424905  5.044284e-04 0.5561173
x14                         0.8794810          1.269519  2.695316e-04 0.5050505
x15                         0.8569809          1.196389 -6.944834e-06 0.4439064
x16                         0.8683444          1.461370  9.876928e-04 0.7820435
x17                         0.8379314          1.289840  6.256742e-04 0.7408159
x18                         0.8873070          1.274651  5.299658e-04 0.6380393
x19                         0.8530395          1.161455 -3.543785e-05 0.5356782
x20                         0.8671349          1.341210  7.876767e-04 0.6380393
x21                         0.8116286          1.448093  5.254994e-04 0.6380393
x22                         0.8184398          1.308259  6.389549e-04 0.5765729
x23                         0.9085678          1.325340  1.084621e-03 0.5561173
x24                         0.8605541          1.244335  3.322233e-04 0.5663430
x25                         0.8604514          1.167202  7.097453e-05 0.5254648
x26                         0.9118618          1.206198  4.303555e-04 0.5561173
x27                         0.7285681          1.509599  1.357411e-04 0.7305195
x28                         0.8919324          1.405116  6.438717e-04 0.5050505
x29                         0.8433792          1.143503 -6.263066e-06 0.5254648
x30                         0.8229722          1.191680 -4.134123e-05 0.6277845
x31                         0.8680937          1.326205  8.710024e-04 0.5050505
x32                         0.8939182          1.190676  1.445649e-04 0.4642713
x33                         0.7832316          1.155177 -4.063861e-04 0.4846527
x34                         0.7349533          1.188453  8.891191e-05 0.6585613
x35                         0.8918269          1.268282  5.855454e-04 0.5970451
x36                         0.8674660          1.317154  5.312033e-04 0.5356782
x37                         0.7210391          1.291327  7.095121e-04 0.7202272
x38                         0.8261443          1.250842 -1.126938e-04 0.4744599
x39                         0.8333212          1.251193  5.628711e-04 0.5868070
x40                         0.8211284          1.249110  5.679428e-05 0.5050505
x41                         0.8280686          1.326992  2.938553e-04 0.5663430
x42                         0.6318322          1.280323 -9.611759e-04 0.6790999
x43                         0.8218509          1.180437 -5.822998e-05 0.5458957
x44                         0.9003903          1.162963  1.975877e-04 0.4642713
x45                         0.8306465          1.255407  4.691515e-04 0.5356782
x46                         0.7617528          1.211680  4.649255e-05 0.5458957
x47                         0.8905450          1.280452  4.999281e-04 0.5868070
x48                         0.8663517          1.727901  2.792541e-03 0.7717303
x49                         0.8531437          1.394760  5.621110e-04 0.5868070
x50                         0.5936778          1.260544 -7.355524e-04 0.5663430
LogBetaPriorSd1                    NA                NA -1.413164e+00        NA
LogLikelihood                      NA                NA  1.021202e+01        NA
ModelSizePartition1                NA                NA            NA        NA</code></pre>
<pre class="r"><code>TopModels(res)</code></pre>
<pre><code>      x1 x10 x11 x12 x16 x17 x18 x22 x23 x25 x26 x27 x35 x37 x39 x40 x41 x45
 [1,]  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 [2,]  1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 [3,]  0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 [4,]  0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0
 [5,]  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0
 [6,]  0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0
 [7,]  0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0
 [8,]  0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 [9,]  0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0
[10,]  0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0
[11,]  0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0
[12,]  0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0
[13,]  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1
[14,]  0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0
[15,]  0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
[16,]  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
[17,]  0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0
[18,]  0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0
[19,]  0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0
[20,]  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0
      x46 Post Prob
 [1,]   0    0.6756
 [2,]   0    0.0060
 [3,]   0    0.0056
 [4,]   0    0.0052
 [5,]   0    0.0050
 [6,]   0    0.0050
 [7,]   0    0.0050
 [8,]   0    0.0050
 [9,]   0    0.0046
[10,]   0    0.0046
[11,]   0    0.0044
[12,]   0    0.0044
[13,]   0    0.0042
[14,]   0    0.0042
[15,]   0    0.0042
[16,]   1    0.0040
[17,]   0    0.0040
[18,]   0    0.0040
[19,]   0    0.0040
[20,]   0    0.0038</code></pre>
</div>
<div id="data-3-simulated-from-one-predictor-model.-predictors-are-independent." class="section level3">
<h3>Data 3: simulated from one predictor model. Predictors are independent.</h3>
<pre class="r"><code>p = 50
X = as.data.frame(dat[[3]][, c(2:(p+1))])
data = dat[[3]]
data$surT = data$surT/max(data$surT)
predictors = names(data)[2:51]
for (v in predictors) {data[,v] &lt;- scale(as.numeric(data[,v]))} # Normalise predictors

res &lt;- R2BGLiMS(
  likelihood=&quot;Weibull&quot;,
  data=data,
  outcome.var=&quot;status&quot;,
  times.var=&quot;surT&quot;,
  model.space.priors=list(list(&quot;a&quot;=1,&quot;b&quot;=length(predictors),&quot;Variables&quot;=predictors)) # Beta-binomial(1,P) model space prior
)

plot(res@mcmc.output[,&quot;LogLikelihood&quot;], type=&quot;l&quot;) # Looks ok</code></pre>
<p><img src="figure/R2BGLiMS.Rmd/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-6-1">
Past versions of unnamed-chunk-6-1.png
</button>
</p>
<div id="fig-unnamed-chunk-6-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/yunqiyang0215/survival-susie/blob/2c660007b36317c1351d015155b31bbb0905af22/docs/figure/R2BGLiMS.Rmd/unnamed-chunk-6-1.png" target="_blank">2c66000</a>
</td>
<td>
yunqiyang0215
</td>
<td>
2024-01-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>ManhattanPlot(res) # Clear signal at Kern</code></pre>
<p><img src="figure/R2BGLiMS.Rmd/unnamed-chunk-6-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-6-2">
Past versions of unnamed-chunk-6-2.png
</button>
</p>
<div id="fig-unnamed-chunk-6-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/yunqiyang0215/survival-susie/blob/2c660007b36317c1351d015155b31bbb0905af22/docs/figure/R2BGLiMS.Rmd/unnamed-chunk-6-2.png" target="_blank">2c66000</a>
</td>
<td>
yunqiyang0215
</td>
<td>
2024-01-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>res@posterior.summary.table</code></pre>
<pre><code>                    PostProb       Median    CrI_Lower    CrI_Upper
LogWeibullScale           NA   0.12236750  -0.07551654   0.31240622
alpha                     NA   7.95033789   6.46708601   9.58694336
x1                    1.0000   0.03023852   0.01419267   0.05926351
x2                    0.0014   1.00000000   1.00000000   1.00000000
x3                    0.0036   1.00000000   1.00000000   1.00000000
x4                    0.1072   1.00000000   0.59211368   1.00000000
x5                    0.0022   1.00000000   1.00000000   1.00000000
x6                    0.0052   1.00000000   1.00000000   1.00000000
x7                    0.0104   1.00000000   1.00000000   1.00000000
x8                    0.0018   1.00000000   1.00000000   1.00000000
x9                    0.0034   1.00000000   1.00000000   1.00000000
x10                   0.0022   1.00000000   1.00000000   1.00000000
x11                   0.0038   1.00000000   1.00000000   1.00000000
x12                   0.0058   1.00000000   1.00000000   1.00000000
x13                   0.0048   1.00000000   1.00000000   1.00000000
x14                   0.0038   1.00000000   1.00000000   1.00000000
x15                   0.0048   1.00000000   1.00000000   1.00000000
x16                   0.0062   1.00000000   1.00000000   1.00000000
x17                   0.0030   1.00000000   1.00000000   1.00000000
x18                   0.0028   1.00000000   1.00000000   1.00000000
x19                   0.0024   1.00000000   1.00000000   1.00000000
x20                   0.0070   1.00000000   1.00000000   1.00000000
x21                   0.0024   1.00000000   1.00000000   1.00000000
x22                   0.0024   1.00000000   1.00000000   1.00000000
x23                   0.0042   1.00000000   1.00000000   1.00000000
x24                   0.0020   1.00000000   1.00000000   1.00000000
x25                   0.0024   1.00000000   1.00000000   1.00000000
x26                   0.0038   1.00000000   1.00000000   1.00000000
x27                   0.0020   1.00000000   1.00000000   1.00000000
x28                   0.0016   1.00000000   1.00000000   1.00000000
x29                   0.0022   1.00000000   1.00000000   1.00000000
x30                   0.0040   1.00000000   1.00000000   1.00000000
x31                   0.0038   1.00000000   1.00000000   1.00000000
x32                   0.0016   1.00000000   1.00000000   1.00000000
x33                   0.0136   1.00000000   1.00000000   1.00000000
x34                   0.0016   1.00000000   1.00000000   1.00000000
x35                   0.0038   1.00000000   1.00000000   1.00000000
x36                   0.0028   1.00000000   1.00000000   1.00000000
x37                   0.0054   1.00000000   1.00000000   1.00000000
x38                   0.0078   1.00000000   1.00000000   1.00000000
x39                   0.0030   1.00000000   1.00000000   1.00000000
x40                   0.0036   1.00000000   1.00000000   1.00000000
x41                   0.0006   1.00000000   1.00000000   1.00000000
x42                   0.0050   1.00000000   1.00000000   1.00000000
x43                   0.0032   1.00000000   1.00000000   1.00000000
x44                   0.0018   1.00000000   1.00000000   1.00000000
x45                   0.0022   1.00000000   1.00000000   1.00000000
x46                   0.0016   1.00000000   1.00000000   1.00000000
x47                   0.0040   1.00000000   1.00000000   1.00000000
x48                   0.0032   1.00000000   1.00000000   1.00000000
x49                   0.0034   1.00000000   1.00000000   1.00000000
x50                   0.0020   1.00000000   1.00000000   1.00000000
LogBetaPriorSd1           NA   0.52856576   0.08858108   0.68659782
LogLikelihood             NA 363.52391316 359.70265021 368.13935461
ModelSizePartition1       NA   1.00000000   1.00000000   3.00000000
                    Median_Present CrI_Lower_Present CrI_Upper_Present
LogWeibullScale                 NA                NA                NA
alpha                           NA                NA                NA
x1                      0.03023852        0.01419267        0.05926351
x2                      0.92737944        0.78660828        1.11627197
x3                      1.07037826        0.88029152        1.30421132
x4                      0.66139254        0.49850921        0.88754879
x5                      0.97300508        0.84937141        1.30131596
x6                      0.84577574        0.69490419        1.10002146
x7                      1.37241132        0.99110997        1.76544080
x8                      1.03569991        0.90928340        1.42834813
x9                      0.90648647        0.74975547        1.33963364
x10                     1.16818488        1.00029358        1.39904186
x11                     1.08021189        0.95106846        1.43795758
x12                     1.23762253        0.95447797        1.45459773
x13                     1.09497550        0.96417597        1.25799046
x14                     0.84766746        0.63639662        1.24174734
x15                     0.87740256        0.72021105        1.10293270
x16                     1.12329962        0.84013196        1.52576618
x17                     1.00294345        0.81762189        1.19610846
x18                     0.91337804        0.76212527        1.13935775
x19                     0.89111186        0.69045290        1.15375079
x20                     1.17176400        1.01255282        1.56961341
x21                     1.01972408        0.75963457        1.51985197
x22                     1.06774112        0.90255730        1.34154502
x23                     1.13096893        0.91266221        1.42275938
x24                     0.99033068        0.85597885        1.19666030
x25                     1.13676514        0.93251983        1.51059289
x26                     1.14861382        0.84092548        1.36306584
x27                     1.05806722        0.84521836        1.27599493
x28                     0.98740428        0.84658278        1.29534760
x29                     0.91733828        0.72261299        1.04771945
x30                     0.80349983        0.64794159        0.97783568
x31                     1.11995460        0.95027721        1.38163473
x32                     0.91496486        0.82751425        1.00559323
x33                     0.75817889        0.58958838        0.96269796
x34                     0.99444927        0.85294002        1.13452680
x35                     1.22810317        0.86490327        1.57817032
x36                     1.26545646        1.08489179        1.44278095
x37                     1.21197206        0.94823085        1.55068875
x38                     0.79141100        0.62889227        1.08519575
x39                     1.05102374        0.90685548        1.25888537
x40                     0.86515512        0.59132322        1.10234725
x41                     0.81800005        0.61256748        0.83053554
x42                     0.83171280        0.63395963        1.15448249
x43                     0.97629304        0.78450731        1.21679784
x44                     1.07847279        0.95307736        1.34293794
x45                     0.89996482        0.63061960        1.01463950
x46                     0.94275085        0.82582540        1.13403138
x47                     1.24550926        1.00478632        1.46070033
x48                     1.16367611        0.79623921        1.43257329
x49                     0.98209981        0.81224269        1.28655332
x50                     0.89761196        0.74485291        1.05713501
LogBetaPriorSd1                 NA                NA                NA
LogLikelihood                   NA                NA                NA
ModelSizePartition1             NA                NA                NA
                             Mean         BF
LogWeibullScale      1.206658e-01         NA
alpha                7.972343e+00         NA
x1                  -3.506423e+00        Inf
x2                  -1.190127e-04 0.07009814
x3                   2.213919e-04 0.18065034
x4                  -4.514038e-02 6.00358423
x5                   3.900964e-05 0.11024253
x6                  -8.834591e-04 0.26135907
x7                   3.050797e-03 0.52546483
x8                   1.817279e-04 0.09016229
x9                  -1.796368e-04 0.17057997
x10                  3.075985e-04 0.11024253
x11                  4.518225e-04 0.19072475
x12                  1.042631e-03 0.29169181
x13                  4.345822e-04 0.24115756
x14                 -5.082639e-04 0.19072475
x15                 -6.348838e-04 0.24115756
x16                  7.511297e-04 0.31193399
x17                  8.888405e-05 0.15045135
x18                 -2.199700e-04 0.14039310
x19                 -2.807545e-04 0.12028869
x20                  1.428588e-03 0.35246727
x21                  9.544754e-05 0.12028869
x22                  1.773674e-04 0.12028869
x23                  5.788534e-04 0.21088572
x24                 -2.620560e-05 0.10020040
x25                  3.509216e-04 0.12028869
x26                  3.235943e-04 0.19072475
x27                  1.004083e-04 0.10020040
x28                  2.901547e-05 0.08012821
x29                 -2.097006e-04 0.11024253
x30                 -8.429661e-04 0.20080321
x31                  4.791545e-04 0.19072475
x32                 -1.462143e-04 0.08012821
x33                 -3.770174e-03 0.68937551
x34                 -3.986207e-05 0.08012821
x35                  7.070586e-04 0.19072475
x36                  6.623607e-04 0.14039310
x37                  1.128060e-03 0.27146592
x38                 -1.602672e-03 0.39306591
x39                  1.705205e-04 0.15045135
x40                 -6.292833e-04 0.18065034
x41                 -1.782189e-04 0.03001801
x42                 -8.342476e-04 0.25125628
x43                 -9.716610e-05 0.16051364
x44                  1.958192e-04 0.09016229
x45                 -3.496646e-04 0.11024253
x46                 -7.797412e-05 0.08012821
x47                  7.947212e-04 0.20080321
x48                  3.281897e-04 0.16051364
x49                  4.842834e-05 0.17057997
x50                 -2.205591e-04 0.10020040
LogBetaPriorSd1      4.904015e-01         NA
LogLikelihood        3.634793e+02         NA
ModelSizePartition1            NA         NA</code></pre>
<pre class="r"><code>TopModels(res)</code></pre>
<pre><code>      x1 x4 x6 x7 x12 x13 x14 x15 x16 x20 x26 x30 x33 x35 x37 x38 x40 x42 x47
 [1,]  1  0  0  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 [2,]  1  1  0  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 [3,]  1  0  0  0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0
 [4,]  1  0  0  1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 [5,]  1  0  0  0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0
 [6,]  1  0  0  0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0
 [7,]  1  0  0  0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 [8,]  1  0  0  0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0
 [9,]  1  0  0  0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0
[10,]  1  0  0  0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0
[11,]  1  0  0  0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0
[12,]  1  0  1  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
[13,]  1  1  0  0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0
[14,]  1  0  0  0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0
[15,]  1  0  0  0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0
[16,]  1  0  0  0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0
[17,]  1  0  0  0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0
[18,]  1  0  0  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1
[19,]  1  0  0  0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0
[20,]  1  0  0  0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0
      Post Prob
 [1,]    0.7658
 [2,]    0.0784
 [3,]    0.0064
 [4,]    0.0060
 [5,]    0.0054
 [6,]    0.0044
 [7,]    0.0040
 [8,]    0.0038
 [9,]    0.0038
[10,]    0.0036
[11,]    0.0034
[12,]    0.0034
[13,]    0.0034
[14,]    0.0032
[15,]    0.0032
[16,]    0.0030
[17,]    0.0030
[18,]    0.0028
[19,]    0.0028
[20,]    0.0028</code></pre>
</div>
<div id="data-4-simulated-from-one-predictor-model.-predictors-are-highly-correlated-corr-0.9" class="section level3">
<h3>Data 4: simulated from one predictor model. Predictors are highly correlated, corr = 0.9</h3>
<pre class="r"><code>p = 50
X = as.data.frame(dat[[4]][, c(2:(p+1))])
data = dat[[4]]
data$surT = data$surT/max(data$surT)
predictors = names(data)[2:51]
for (v in predictors) {data[,v] &lt;- scale(as.numeric(data[,v]))} # Normalise predictors

res &lt;- R2BGLiMS(
  likelihood=&quot;Weibull&quot;,
  data=data,
  outcome.var=&quot;status&quot;,
  times.var=&quot;surT&quot;,
  model.space.priors=list(list(&quot;a&quot;=1,&quot;b&quot;=length(predictors),&quot;Variables&quot;=predictors)) # Beta-binomial(1,P) model space prior
)

plot(res@mcmc.output[,&quot;LogLikelihood&quot;], type=&quot;l&quot;) # Looks ok</code></pre>
<p><img src="figure/R2BGLiMS.Rmd/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-7-1">
Past versions of unnamed-chunk-7-1.png
</button>
</p>
<div id="fig-unnamed-chunk-7-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/yunqiyang0215/survival-susie/blob/2c660007b36317c1351d015155b31bbb0905af22/docs/figure/R2BGLiMS.Rmd/unnamed-chunk-7-1.png" target="_blank">2c66000</a>
</td>
<td>
yunqiyang0215
</td>
<td>
2024-01-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>ManhattanPlot(res) # Clear signal at Kern</code></pre>
<p><img src="figure/R2BGLiMS.Rmd/unnamed-chunk-7-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-7-2">
Past versions of unnamed-chunk-7-2.png
</button>
</p>
<div id="fig-unnamed-chunk-7-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/yunqiyang0215/survival-susie/blob/2c660007b36317c1351d015155b31bbb0905af22/docs/figure/R2BGLiMS.Rmd/unnamed-chunk-7-2.png" target="_blank">2c66000</a>
</td>
<td>
yunqiyang0215
</td>
<td>
2024-01-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>res@posterior.summary.table</code></pre>
<pre><code>                    PostProb      Median    CrI_Lower   CrI_Upper
LogWeibullScale           NA   0.1396036  -0.05458087   0.3246793
alpha                     NA   7.7164561   6.31564843   9.2856496
x1                    1.0000   0.0554355   0.02585558   0.1313702
x2                    0.0068   1.0000000   1.00000000   1.0000000
x3                    0.0054   1.0000000   1.00000000   1.0000000
x4                    0.1882   1.0000000   0.28920532   1.0000000
x5                    0.0084   1.0000000   1.00000000   1.0000000
x6                    0.0066   1.0000000   1.00000000   1.0000000
x7                    0.0088   1.0000000   1.00000000   1.0000000
x8                    0.0052   1.0000000   1.00000000   1.0000000
x9                    0.0060   1.0000000   1.00000000   1.0000000
x10                   0.0030   1.0000000   1.00000000   1.0000000
x11                   0.0088   1.0000000   1.00000000   1.0000000
x12                   0.0176   1.0000000   1.00000000   1.0000000
x13                   0.0056   1.0000000   1.00000000   1.0000000
x14                   0.0072   1.0000000   1.00000000   1.0000000
x15                   0.0060   1.0000000   1.00000000   1.0000000
x16                   0.0108   1.0000000   1.00000000   1.0000000
x17                   0.0068   1.0000000   1.00000000   1.0000000
x18                   0.0088   1.0000000   1.00000000   1.0000000
x19                   0.0106   1.0000000   1.00000000   1.0000000
x20                   0.0050   1.0000000   1.00000000   1.0000000
x21                   0.0044   1.0000000   1.00000000   1.0000000
x22                   0.0042   1.0000000   1.00000000   1.0000000
x23                   0.0066   1.0000000   1.00000000   1.0000000
x24                   0.0044   1.0000000   1.00000000   1.0000000
x25                   0.0042   1.0000000   1.00000000   1.0000000
x26                   0.0046   1.0000000   1.00000000   1.0000000
x27                   0.0088   1.0000000   1.00000000   1.0000000
x28                   0.0064   1.0000000   1.00000000   1.0000000
x29                   0.0042   1.0000000   1.00000000   1.0000000
x30                   0.0098   1.0000000   1.00000000   1.0000000
x31                   0.0080   1.0000000   1.00000000   1.0000000
x32                   0.0184   1.0000000   1.00000000   1.0000000
x33                   0.0120   1.0000000   1.00000000   1.0000000
x34                   0.0036   1.0000000   1.00000000   1.0000000
x35                   0.0060   1.0000000   1.00000000   1.0000000
x36                   0.0056   1.0000000   1.00000000   1.0000000
x37                   0.0082   1.0000000   1.00000000   1.0000000
x38                   0.0192   1.0000000   1.00000000   1.0000000
x39                   0.0052   1.0000000   1.00000000   1.0000000
x40                   0.0052   1.0000000   1.00000000   1.0000000
x41                   0.0118   1.0000000   1.00000000   1.0000000
x42                   0.0090   1.0000000   1.00000000   1.0000000
x43                   0.0062   1.0000000   1.00000000   1.0000000
x44                   0.0056   1.0000000   1.00000000   1.0000000
x45                   0.0046   1.0000000   1.00000000   1.0000000
x46                   0.0036   1.0000000   1.00000000   1.0000000
x47                   0.0116   1.0000000   1.00000000   1.0000000
x48                   0.0098   1.0000000   1.00000000   1.0000000
x49                   0.0064   1.0000000   1.00000000   1.0000000
x50                   0.0052   1.0000000   1.00000000   1.0000000
LogBetaPriorSd1           NA   0.4622272  -0.06864749   0.6818509
LogLikelihood             NA 344.8071806 340.90905060 349.0118433
ModelSizePartition1       NA   1.0000000   1.00000000   4.0000000
                    Median_Present CrI_Lower_Present CrI_Upper_Present
LogWeibullScale                 NA                NA                NA
alpha                           NA                NA                NA
x1                       0.0554355        0.02585558         0.1313702
x2                       0.8857893        0.55645537         1.4664117
x3                       0.9914912        0.67834975         1.9845688
x4                       0.4142105        0.20922588         0.7712065
x5                       0.8133367        0.45794779         1.3954797
x6                       0.8537980        0.60356458         1.2956409
x7                       1.3626189        0.68208847         2.1836988
x8                       0.9989412        0.59142567         1.4877958
x9                       0.8792868        0.48166244         1.3559148
x10                      1.1396543        0.76465726         1.6710761
x11                      1.5087442        0.71902079         2.1047910
x12                      1.5844556        0.92962292         2.4311459
x13                      1.0392080        0.66470733         1.8531783
x14                      0.7645252        0.34151103         1.2781956
x15                      0.7861090        0.64095034         1.1313962
x16                      1.4405776        0.66470529         3.2985007
x17                      1.2187081        0.66538349         1.6640232
x18                      0.9807620        0.61081376         1.6701821
x19                      0.8267537        0.57356226         1.5243539
x20                      1.2231491        0.84138076         1.7760750
x21                      0.9117237        0.66943003         1.4940610
x22                      1.0578582        0.69120971         1.9645325
x23                      1.4570355        0.78615097         2.2725103
x24                      0.9596987        0.57851351         1.5653175
x25                      1.0561829        0.71995211         1.5632374
x26                      1.0611950        0.54091172         1.5602705
x27                      1.3845132        0.72341576         3.3377579
x28                      0.9110244        0.60449248         1.5217168
x29                      0.9844121        0.72479936         1.4771682
x30                      0.5852455        0.47190582         0.8757247
x31                      1.2742956        0.62874809         2.1395023
x32                      0.6494636        0.42785597         1.4457585
x33                      0.6719910        0.38886536         1.1486831
x34                      0.9691736        0.81382868         1.3770341
x35                      1.1473284        0.76434328         1.7839831
x36                      1.0883056        0.51224470         1.5337735
x37                      1.2593770        0.82735358         1.8964173
x38                      0.6139791        0.32749280         1.2542077
x39                      1.0776952        0.63340120         1.4152742
x40                      0.7729378        0.40191933         1.0576979
x41                      0.7205598        0.46416700         1.3710669
x42                      0.8144056        0.38814939         1.2165949
x43                      1.0095649        0.67566256         1.4203038
x44                      1.1324521        0.68152679         1.6625755
x45                      0.9014007        0.53189891         1.3582656
x46                      0.9544083        0.67786372         1.2017958
x47                      1.3504380        0.79907013         2.0469262
x48                      1.4232377        0.73074742         3.5731963
x49                      1.1135361        0.70465060         1.4720548
x50                      0.7956456        0.59035749         1.2759903
LogBetaPriorSd1                 NA                NA                NA
LogLikelihood                   NA                NA                NA
ModelSizePartition1             NA                NA                NA
                             Mean         BF
LogWeibullScale      1.383587e-01         NA
alpha                7.738417e+00         NA
x1                  -2.875393e+00        Inf
x2                  -1.038961e-03  0.3423278
x3                   4.605615e-04  0.2714659
x4                  -1.672738e-01 11.5915250
x5                  -2.049833e-03  0.4235579
x6                  -1.103091e-03  0.3321925
x7                   2.478640e-03  0.4439064
x8                  -1.638271e-04  0.2613591
x9                  -1.025284e-03  0.3018109
x10                  3.156279e-04  0.1504514
x11                  2.754701e-03  0.4439064
x12                  7.915123e-03  0.8957655
x13                  4.267747e-04  0.2815768
x14                 -2.541144e-03  0.3626108
x15                 -1.185692e-03  0.3018109
x16                  5.193445e-03  0.5458957
x17                  1.235945e-03  0.3423278
x18                 -1.193211e-04  0.4439064
x19                 -1.644330e-03  0.5356782
x20                  1.037765e-03  0.2512563
x21                 -3.422325e-04  0.2209723
x22                  3.592672e-04  0.2108857
x23                  2.423056e-03  0.3321925
x24                  1.736634e-05  0.2209723
x25                  2.877496e-04  0.2108857
x26                 -3.483957e-05  0.2310629
x27                  3.162135e-03  0.4439064
x28                 -4.483461e-04  0.3220612
x29                 -5.323420e-05  0.2108857
x30                 -4.585710e-03  0.4948495
x31                  1.869553e-03  0.4032258
x32                 -6.986879e-03  0.9372453
x33                 -4.651205e-03  0.6072874
x34                  1.597546e-05  0.1806503
x35                  9.563645e-04  0.3018109
x36                  1.618947e-04  0.2815768
x37                  1.745242e-03  0.4133898
x38                 -9.105476e-03  0.9787928
x39                  3.774045e-05  0.2613591
x40                 -1.603770e-03  0.2613591
x41                 -3.548190e-03  0.5970451
x42                 -2.537575e-03  0.4540868
x43                 -8.007179e-06  0.3119340
x44                  7.125840e-04  0.2815768
x45                 -4.686826e-04  0.2310629
x46                 -2.593369e-04  0.1806503
x47                  3.183164e-03  0.5868070
x48                  3.156927e-03  0.4948495
x49                  6.847619e-04  0.3220612
x50                 -9.523115e-04  0.2613591
LogBetaPriorSd1      4.171471e-01         NA
LogLikelihood        3.447598e+02         NA
ModelSizePartition1            NA         NA</code></pre>
<pre class="r"><code>TopModels(res)</code></pre>
<pre><code>      x1 x2 x4 x5 x7 x12 x16 x19 x28 x29 x32 x33 x37 x38 x41 x42 x47 x48 x49
 [1,]  1  0  0  0  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 [2,]  1  0  1  0  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 [3,]  1  0  0  0  0   0   0   0   0   0   1   0   0   0   0   0   0   0   0
 [4,]  1  0  0  0  0   0   0   0   0   0   0   0   0   1   0   0   0   0   0
 [5,]  1  0  0  0  0   0   0   0   0   0   0   1   0   0   0   0   0   0   0
 [6,]  1  0  0  0  0   0   0   0   0   0   0   0   0   0   1   0   0   0   0
 [7,]  1  0  1  0  0   1   0   0   0   0   0   0   0   0   0   0   0   0   0
 [8,]  1  0  0  0  0   0   0   1   0   0   0   0   0   0   0   0   0   0   0
 [9,]  1  0  1  0  0   0   0   0   0   0   0   0   0   0   0   0   1   0   0
[10,]  1  0  1  0  0   0   0   0   0   0   0   0   0   0   0   0   0   1   0
[11,]  1  0  0  0  0   0   0   0   0   0   0   0   0   0   0   1   0   0   0
[12,]  1  0  0  1  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
[13,]  1  0  1  0  0   0   1   0   0   0   0   0   0   0   0   0   0   0   0
[14,]  1  1  0  0  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
[15,]  1  0  0  0  0   0   0   0   0   1   0   0   0   0   0   0   0   0   0
[16,]  1  0  0  0  0   0   0   0   1   0   0   0   0   0   0   0   0   0   0
[17,]  1  0  0  0  1   0   0   0   0   0   0   0   0   0   0   0   0   0   0
[18,]  1  0  0  0  0   0   0   0   0   0   0   0   0   0   0   0   0   0   1
[19,]  1  0  0  0  0   0   0   0   0   0   0   0   1   0   0   0   0   0   0
[20,]  1  0  0  0  0   1   0   0   0   0   0   0   0   0   0   0   0   0   0
      Post Prob
 [1,]    0.6272
 [2,]    0.1006
 [3,]    0.0120
 [4,]    0.0100
 [5,]    0.0082
 [6,]    0.0072
 [7,]    0.0068
 [8,]    0.0062
 [9,]    0.0048
[10,]    0.0044
[11,]    0.0042
[12,]    0.0042
[13,]    0.0042
[14,]    0.0036
[15,]    0.0034
[16,]    0.0034
[17,]    0.0034
[18,]    0.0032
[19,]    0.0032
[20,]    0.0032</code></pre>
</div>
<div id="data-5-simulated-from-two-predictor-model.-predictors-have-high-correlation-corr-0.9" class="section level3">
<h3>Data 5: simulated from two predictor model. Predictors have high correlation, corr = 0.9</h3>
<pre class="r"><code>p = 50
X = as.data.frame(dat[[5]][, c(2:(p+1))])
data = dat[[5]]
data$surT = data$surT/max(data$surT)
predictors = names(data)[2:51]
for (v in predictors) {data[,v] &lt;- scale(as.numeric(data[,v]))} # Normalise predictors

res &lt;- R2BGLiMS(
  likelihood=&quot;Weibull&quot;,
  data=data,
  outcome.var=&quot;status&quot;,
  times.var=&quot;surT&quot;,
  model.space.priors=list(list(&quot;a&quot;=1,&quot;b&quot;=length(predictors),&quot;Variables&quot;=predictors)) # Beta-binomial(1,P) model space prior
)

plot(res@mcmc.output[,&quot;LogLikelihood&quot;], type=&quot;l&quot;) # Looks ok</code></pre>
<p><img src="figure/R2BGLiMS.Rmd/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-8-1">
Past versions of unnamed-chunk-8-1.png
</button>
</p>
<div id="fig-unnamed-chunk-8-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/yunqiyang0215/survival-susie/blob/2c660007b36317c1351d015155b31bbb0905af22/docs/figure/R2BGLiMS.Rmd/unnamed-chunk-8-1.png" target="_blank">2c66000</a>
</td>
<td>
yunqiyang0215
</td>
<td>
2024-01-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>ManhattanPlot(res) # Clear signal at Kern</code></pre>
<p><img src="figure/R2BGLiMS.Rmd/unnamed-chunk-8-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-8-2">
Past versions of unnamed-chunk-8-2.png
</button>
</p>
<div id="fig-unnamed-chunk-8-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/yunqiyang0215/survival-susie/blob/2c660007b36317c1351d015155b31bbb0905af22/docs/figure/R2BGLiMS.Rmd/unnamed-chunk-8-2.png" target="_blank">2c66000</a>
</td>
<td>
yunqiyang0215
</td>
<td>
2024-01-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>res@posterior.summary.table</code></pre>
<pre><code>                    PostProb       Median    CrI_Lower   CrI_Upper
LogWeibullScale           NA   0.12434979  -0.06097042   0.3103664
alpha                     NA  12.44247878  10.33900482  14.9628292
x1                    1.0000   0.07206508   0.03227540   0.1680171
x2                    1.0000   0.17547609   0.08889487   0.3519736
x3                    0.0100   1.00000000   1.00000000   1.0000000
x4                    0.4772   1.00000000   0.20950859   1.0000000
x5                    0.0140   1.00000000   1.00000000   1.0000000
x6                    0.0226   1.00000000   1.00000000   1.0000000
x7                    0.0302   1.00000000   1.00000000   1.1597917
x8                    0.0100   1.00000000   1.00000000   1.0000000
x9                    0.0106   1.00000000   1.00000000   1.0000000
x10                   0.0088   1.00000000   1.00000000   1.0000000
x11                   0.0232   1.00000000   1.00000000   1.0000000
x12                   0.0284   1.00000000   1.00000000   1.1448276
x13                   0.0268   1.00000000   1.00000000   1.0000000
x14                   0.0232   1.00000000   1.00000000   1.0000000
x15                   0.0244   1.00000000   1.00000000   1.0000000
x16                   0.0134   1.00000000   1.00000000   1.0000000
x17                   0.0226   1.00000000   1.00000000   1.0000000
x18                   0.0082   1.00000000   1.00000000   1.0000000
x19                   0.0180   1.00000000   1.00000000   1.0000000
x20                   0.0242   1.00000000   1.00000000   1.0000000
x21                   0.0140   1.00000000   1.00000000   1.0000000
x22                   0.0220   1.00000000   1.00000000   1.0000000
x23                   0.0526   1.00000000   1.00000000   1.9535440
x24                   0.0124   1.00000000   1.00000000   1.0000000
x25                   0.0214   1.00000000   1.00000000   1.0000000
x26                   0.0160   1.00000000   1.00000000   1.0000000
x27                   0.0120   1.00000000   1.00000000   1.0000000
x28                   0.0108   1.00000000   1.00000000   1.0000000
x29                   0.0108   1.00000000   1.00000000   1.0000000
x30                   0.0358   1.00000000   0.76005756   1.0000000
x31                   0.0110   1.00000000   1.00000000   1.0000000
x32                   0.0146   1.00000000   1.00000000   1.0000000
x33                   0.0292   1.00000000   0.93687492   1.0000000
x34                   0.0122   1.00000000   1.00000000   1.0000000
x35                   0.0266   1.00000000   1.00000000   1.0000000
x36                   0.0148   1.00000000   1.00000000   1.0000000
x37                   0.0208   1.00000000   1.00000000   1.0000000
x38                   0.0200   1.00000000   1.00000000   1.0000000
x39                   0.0200   1.00000000   1.00000000   1.0000000
x40                   0.0144   1.00000000   1.00000000   1.0000000
x41                   0.0106   1.00000000   1.00000000   1.0000000
x42                   0.0190   1.00000000   1.00000000   1.0000000
x43                   0.0146   1.00000000   1.00000000   1.0000000
x44                   0.0088   1.00000000   1.00000000   1.0000000
x45                   0.0088   1.00000000   1.00000000   1.0000000
x46                   0.0082   1.00000000   1.00000000   1.0000000
x47                   0.0438   1.00000000   1.00000000   1.7117875
x48                   0.0700   1.00000000   1.00000000   2.2163099
x49                   0.0100   1.00000000   1.00000000   1.0000000
x50                   0.0146   1.00000000   1.00000000   1.0000000
LogBetaPriorSd1           NA   0.42047617  -0.11235499   0.6818720
LogLikelihood             NA 603.38420186 598.93870499 608.1143559
ModelSizePartition1       NA   3.00000000   2.00000000   7.0000000
                    Median_Present CrI_Lower_Present CrI_Upper_Present
LogWeibullScale                 NA                NA                NA
alpha                           NA                NA                NA
x1                      0.07206508        0.03227540         0.1680171
x2                      0.17547609        0.08889487         0.3519736
x3                      1.19926778        0.74077766         2.3535347
x4                      0.36058955        0.18228713         0.6994365
x5                      1.01140325        0.59836193         2.2030825
x6                      0.58812941        0.36407364         1.2419261
x7                      1.61631764        0.83183607         3.4214895
x8                      1.21096154        0.65058786         2.1313611
x9                      1.06615177        0.59396873         1.6334384
x10                     1.12739771        0.69380779         1.7335921
x11                     1.44080137        0.76961355         2.9630902
x12                     1.64917078        0.90494458         2.7615675
x13                     1.66611795        0.75686392         2.7616930
x14                     0.64818809        0.38537733         1.4681443
x15                     0.64340067        0.41013980         1.2106030
x16                     1.28677274        0.73532781         1.7431758
x17                     1.53177918        0.69395001         2.3788522
x18                     1.05830869        0.66004045         1.6427611
x19                     1.29548544        0.71122236         2.2740285
x20                     1.61567486        0.83847472         3.1118491
x21                     0.99390086        0.62488224         1.6429603
x22                     1.45927217        0.79538138         3.3531574
x23                     1.89940933        0.84852093         3.5040776
x24                     1.18746587        0.39766939         1.9874704
x25                     1.20006681        0.49704751         2.1643129
x26                     1.24483449        0.59113623         2.2914739
x27                     1.12602368        0.67397426         2.4400251
x28                     0.99324703        0.54402680         2.1510072
x29                     0.96037231        0.69207891         1.6934022
x30                     0.60679305        0.35025220         1.5690106
x31                     1.13760336        0.55078559         1.9002251
x32                     0.80758827        0.50741894         1.7872258
x33                     0.64826080        0.39388323         1.1120461
x34                     0.94667079        0.47119231         1.7428305
x35                     1.42157204        0.55131069         2.3298574
x36                     1.22551478        0.79400400         1.6731349
x37                     1.45773977        0.85027590         2.3521835
x38                     0.77719230        0.46187339         1.5148864
x39                     1.37885338        0.62171990         2.0909789
x40                     1.02528971        0.50692448         1.9046626
x41                     0.96554306        0.49113484         1.4263794
x42                     0.70656753        0.45962564         1.4182469
x43                     0.87524360        0.50940368         1.6967258
x44                     1.07255211        0.72191186         1.6484047
x45                     0.99313501        0.64370131         1.9146123
x46                     0.94914003        0.53030475         1.7103503
x47                     1.84494569        0.92007852         3.8332689
x48                     2.03341206        0.53660577         3.9101887
x49                     1.00346379        0.66556308         1.3253369
x50                     1.02947311        0.49871160         2.3037615
LogBetaPriorSd1                 NA                NA                NA
LogLikelihood                   NA                NA                NA
ModelSizePartition1             NA                NA                NA
                             Mean         BF
LogWeibullScale      1.260049e-01         NA
alpha                1.251155e+01         NA
x1                  -2.613216e+00        Inf
x2                  -1.739525e+00        Inf
x3                   2.234121e-03  0.5050505
x4                  -4.853147e-01 45.6388676
x5                   7.585801e-04  0.7099391
x6                  -1.065297e-02  1.1561285
x7                   1.418799e-02  1.5570221
x8                   2.002793e-03  0.5050505
x9                   5.820716e-04  0.5356782
x10                  8.077435e-04  0.4439064
x11                  9.662843e-03  1.1875512
x12                  1.306931e-02  1.4615068
x13                  1.235083e-02  1.3769009
x14                 -8.325148e-03  1.1875512
x15                 -9.813061e-03  1.2505125
x16                  2.993333e-03  0.6790999
x17                  7.912779e-03  1.1561285
x18                  1.355501e-04  0.4133898
x19                  4.185207e-03  0.9164969
x20                  9.958718e-03  1.2400082
x21                  1.774436e-04  0.7099391
x22                  9.323754e-03  1.1247444
x23                  3.181977e-02  2.7760186
x24                  4.364823e-05  0.6277845
x25                  2.938029e-03  1.0933987
x26                  2.618232e-03  0.8130081
x27                  1.786379e-03  0.6072874
x28                  5.109008e-04  0.5458957
x29                  2.166450e-04  0.5458957
x30                 -1.597419e-02  1.8564613
x31                  1.015275e-03  0.5561173
x32                 -2.646319e-03  0.7408159
x33                 -1.234232e-02  1.5039143
x34                 -6.878282e-05  0.6175339
x35                  7.588579e-03  1.3663448
x36                  2.820403e-03  0.7511165
x37                  7.855640e-03  1.0620915
x38                 -4.699254e-03  1.0204082
x39                  5.942469e-03  1.0204082
x40                  5.763098e-04  0.7305195
x41                 -8.354233e-04  0.5356782
x42                 -5.556596e-03  0.9683996
x43                 -1.376740e-03  0.7408159
x44                  8.621433e-04  0.4439064
x45                  3.557325e-04  0.4439064
x46                 -3.814944e-04  0.4133898
x47                  2.654628e-02  2.2903158
x48                  4.101878e-02  3.7634409
x49                  2.881808e-05  0.5050505
x50                  1.304825e-03  0.7408159
LogBetaPriorSd1      3.868622e-01         NA
LogLikelihood        6.035343e+02         NA
ModelSizePartition1            NA         NA</code></pre>
<pre class="r"><code>TopModels(res)</code></pre>
<pre><code>      x1 x2 x4 x7 x11 x12 x13 x15 x20 x22 x23 x30 x33 x35 x42 x47 x48 Post Prob
 [1,]  1  1  0  0   0   0   0   0   0   0   0   0   0   0   0   0   0    0.3036
 [2,]  1  1  1  0   0   0   0   0   0   0   0   0   0   0   0   0   0    0.1658
 [3,]  1  1  1  0   0   0   0   0   0   0   1   0   0   0   0   0   0    0.0208
 [4,]  1  1  1  0   0   0   0   0   0   0   0   0   0   0   0   1   0    0.0176
 [5,]  1  1  1  0   0   0   0   0   0   0   0   0   0   0   0   0   1    0.0150
 [6,]  1  1  0  0   0   0   0   0   0   0   0   1   0   0   0   0   0    0.0108
 [7,]  1  1  0  0   0   1   0   0   0   0   0   0   0   0   0   0   0    0.0102
 [8,]  1  1  1  0   1   0   0   0   0   0   0   0   0   0   0   0   0    0.0072
 [9,]  1  1  0  0   0   0   0   0   0   1   0   0   0   0   0   0   0    0.0068
[10,]  1  1  1  1   0   0   0   0   0   0   0   0   0   0   0   0   0    0.0066
[11,]  1  1  0  0   0   0   0   1   0   0   0   0   0   0   0   0   0    0.0058
[12,]  1  1  0  1   0   0   0   0   0   0   0   0   0   0   0   0   0    0.0058
[13,]  1  1  0  0   0   0   0   0   0   0   1   0   0   0   0   0   0    0.0056
[14,]  1  1  0  0   0   0   0   0   0   0   0   0   1   0   0   0   0    0.0054
[15,]  1  1  1  0   0   0   0   0   0   0   0   0   1   0   0   0   0    0.0046
[16,]  1  1  1  0   0   1   0   0   0   0   0   0   0   0   0   0   0    0.0046
[17,]  1  1  0  0   0   0   0   0   0   0   0   0   0   0   1   0   0    0.0044
[18,]  1  1  1  0   0   0   0   0   1   0   0   0   0   0   0   0   0    0.0042
[19,]  1  1  1  0   0   0   1   0   0   0   0   0   0   0   0   0   0    0.0042
[20,]  1  1  1  0   0   0   0   0   0   0   0   0   0   1   0   0   0    0.0040</code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.1.1 (2021-08-10)
Platform: x86_64-apple-darwin20.6.0 (64-bit)
Running under: macOS Monterey 12.0.1

Matrix products: default
BLAS:   /usr/local/Cellar/openblas/0.3.18/lib/libopenblasp-r0.3.18.dylib
LAPACK: /usr/local/Cellar/r/4.1.1_1/lib/R/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] survival_3.2-11         R2BGLiMS_0.1-07-02-2020 workflowr_1.6.2        

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.8.3     highr_0.9        pillar_1.6.4     compiler_4.1.1  
 [5] bslib_0.4.1      later_1.3.0      jquerylib_0.1.4  git2r_0.28.0    
 [9] tools_4.1.1      digest_0.6.28    lattice_0.20-44  jsonlite_1.7.2  
[13] evaluate_0.14    lifecycle_1.0.3  tibble_3.1.5     pkgconfig_2.0.3 
[17] rlang_1.1.1      Matrix_1.5-3     cli_3.6.1        rstudioapi_0.13 
[21] yaml_2.2.1       xfun_0.27        fastmap_1.1.0    stringr_1.4.0   
[25] knitr_1.36       fs_1.5.0         vctrs_0.6.3      sass_0.4.4      
[29] grid_4.1.1       rprojroot_2.0.2  glue_1.4.2       R6_2.5.1        
[33] fansi_0.5.0      rmarkdown_2.11   magrittr_2.0.1   whisker_0.4     
[37] splines_4.1.1    promises_1.2.0.1 ellipsis_0.3.2   htmltools_0.5.5 
[41] httpuv_1.6.3     utf8_1.2.2       stringi_1.7.5    cachem_1.0.6    
[45] crayon_1.4.1    </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
